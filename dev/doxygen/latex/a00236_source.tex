\hypertarget{a00236_source}{}\doxysection{svk.\+hh}
\label{a00236_source}\index{svk.hh@{svk.hh}}
\mbox{\hyperlink{a00236}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2025 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a03068}{ikarus/finiteelements/mechanics/materials/interface.hh}}>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00032}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00422}{Ikarus::Materials}} \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{35 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{36 \textcolor{keyword}{struct }\mbox{\hyperlink{a01634}{StVenantKirchhoffT}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01622}{Material}}<StVenantKirchhoffT<ST>>}
\DoxyCodeLine{37 \{}
\DoxyCodeLine{38   \textcolor{keyword}{using }\mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}}         = ST;}
\DoxyCodeLine{39   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01634_a6c753a1072ccabce719340b617e647e7}{dim}} = 3;}
\DoxyCodeLine{40   \textcolor{keyword}{using }\mbox{\hyperlink{a01634_a7f9b9e2520e939b6c38bc8fe6452716f}{StrainMatrix}}       = Eigen::Matrix<ScalarType, dim, dim>;}
\DoxyCodeLine{41   \textcolor{keyword}{using }\mbox{\hyperlink{a01634_a824df7ac9c3f7ea733cbe654bfe5f4ad}{StressMatrix}}       = \mbox{\hyperlink{a01634_a7f9b9e2520e939b6c38bc8fe6452716f}{StrainMatrix}};}
\DoxyCodeLine{42   \textcolor{keyword}{using }\mbox{\hyperlink{a01634_acd3ff90a473ab0f184c04ff710f0640b}{MaterialTensor}}     = Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<dim, dim, dim, dim>>;}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   \textcolor{keyword}{using }\mbox{\hyperlink{a01710}{MaterialParameters}} = \mbox{\hyperlink{a01710}{LamesFirstParameterAndShearModulus}};}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01634_a6abf350e4e39d3c6f4d0c568ec1d4e31}{strainTag}}              = \mbox{\hyperlink{a00400_ggacef1e451de1a99845c59d7391064fb8faca3f1e4bb21fd00a3d29c5d8aff8e11e}{StrainTags::greenLagrangian}};}
\DoxyCodeLine{47   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01634_aaa031b8d94a24804305a084e8b5913a8}{stressTag}}              = \mbox{\hyperlink{a00400_gga70b4ce43c53cc5e949d49919f437501eab13248d68ac5516c015337b68346fc21}{StressTags::PK2}};}
\DoxyCodeLine{48   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01634_af457c768265c73ddb602f6762d73e655}{tangentModuliTag}}       = \mbox{\hyperlink{a00400_gga05ac785124262c1e323d2f937d520a1bad92a8333dd3ccb895cc65f7455b71206}{TangentModuliTags::Material}};}
\DoxyCodeLine{49   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01634_ae62a6d88db837e254b04d445ba9887d6}{energyAcceptsVoigt}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{50   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01634_ada24449a84864acc3a226f539dd1207b}{stressToVoigt}}          = \textcolor{keyword}{true};}
\DoxyCodeLine{51   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01634_aa9c1139f575cb45aafb6541bf18df9a1}{stressAcceptsVoigt}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{52   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01634_a565aec5081b00d174a75171a328ec376}{moduliToVoigt}}          = \textcolor{keyword}{true};}
\DoxyCodeLine{53   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01634_ad856f729911290f013cefb91b3efcd6a}{moduliAcceptsVoigt}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{54   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{double} \mbox{\hyperlink{a01634_a9a18d987624d47406ebff09243b23595}{derivativeFactorImpl}} = 1;}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keyword}{static} std::string \mbox{\hyperlink{a01634_a2e44e78e45338a9b862c3ae300556e01}{nameImpl}}() \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}StVenantKirchhoff"{}}; \}}
\DoxyCodeLine{57 }
\DoxyCodeLine{62   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01634_aa4c4ff4a1fa0d8105a3971bef0bb76f2}{StVenantKirchhoffT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01710}{MaterialParameters}}\& mpt)}
\DoxyCodeLine{63       : materialParameter\_\{mpt\} \{\}}
\DoxyCodeLine{64 }
\DoxyCodeLine{68   \mbox{\hyperlink{a01710}{MaterialParameters}} \mbox{\hyperlink{a01634_ae62fdcbfcd8b34d2714ca15cc2893fd8}{materialParametersImpl}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} materialParameter\_; \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{76   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{77   \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}} \mbox{\hyperlink{a01634_a873be18f1f6da8a37a68ea73adf0e004}{storedEnergyImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& E)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{78     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{79     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{80       \textcolor{keyword}{const} \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}} traceE = E.template segment<3>(0).sum();}
\DoxyCodeLine{81       \textcolor{keyword}{const} \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}} squaredNorm =}
\DoxyCodeLine{82           E.template segment<3>(0).squaredNorm() + E.template segment<3>(3).squaredNorm() / \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}}(2.0);}
\DoxyCodeLine{83       \textcolor{keywordflow}{return} materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}}(2.0) * traceE * traceE + materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * squaredNorm;}
\DoxyCodeLine{84     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{85       \textcolor{keyword}{const} \textcolor{keyword}{auto} traceE = E.trace();}
\DoxyCodeLine{86       \textcolor{keywordflow}{return} materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}}(2.0) * traceE * traceE + materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E.squaredNorm();}
\DoxyCodeLine{87     \}}
\DoxyCodeLine{88   \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{97   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{98   \textcolor{keyword}{auto} \mbox{\hyperlink{a01634_a110892a58af485f91169a63ca2253ef2}{stressesImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& E)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{99     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<\textcolor{keyword}{decltype}(E.eval())>);}
\DoxyCodeLine{100     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ed = E.derived();}
\DoxyCodeLine{101     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{102       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{103         \textcolor{keyword}{static\_assert}(Concepts::EigenVector6<Derived>);}
\DoxyCodeLine{104         \mbox{\hyperlink{a01634_a824df7ac9c3f7ea733cbe654bfe5f4ad}{StressMatrix}} S;}
\DoxyCodeLine{105         \textcolor{keyword}{const} \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}} traceE = Ed.template segment<3>(0).sum();}
\DoxyCodeLine{106         S.diagonal().array() =}
\DoxyCodeLine{107             materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * traceE + 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed.template segment<3>(0).array();}
\DoxyCodeLine{108         S(1, 2) = S(2, 1) = materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(3);}
\DoxyCodeLine{109         S(0, 2) = S(2, 0) = materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(4);}
\DoxyCodeLine{110         S(0, 1) = S(1, 0) = materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(5); \textcolor{comment}{// no two since E voigt has 2* on off-\/diagonal terms}}
\DoxyCodeLine{111         \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{112       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{113         \textcolor{keyword}{static\_assert}(Concepts::EigenMatrix33<Derived>);}
\DoxyCodeLine{114         \textcolor{keywordflow}{return} (materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * Ed.trace() * StrainMatrix::Identity() + 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed)}
\DoxyCodeLine{115             .eval();}
\DoxyCodeLine{116       \}}
\DoxyCodeLine{117     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{118       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{119         \textcolor{keyword}{static\_assert}(Concepts::EigenVector6<Derived>);}
\DoxyCodeLine{120         Eigen::Matrix<ScalarType, 6, 1> S;}
\DoxyCodeLine{121         \textcolor{keyword}{const} \mbox{\hyperlink{a01634_a0475aedeb5b5e189c961fe80b99a820e}{ScalarType}} traceE          = Ed.template segment<3>(0).sum();}
\DoxyCodeLine{122         S.template segment<3>(0).array() = traceE * materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{123         S.template segment<3>(0) += materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * 2 * Ed.template segment<3>(0);}
\DoxyCodeLine{124         S.template segment<3>(3) =}
\DoxyCodeLine{125             materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed.template segment<3>(3); \textcolor{comment}{// no two since E voigt has 2* on off-\/diagonal terms}}
\DoxyCodeLine{126         \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{127       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{128         Eigen::Matrix<ScalarType, 6, 1> S;}
\DoxyCodeLine{129         S.template segment<3>(0).array() = Ed.trace() * materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{130         S.template segment<3>(0) += 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed.diagonal();}
\DoxyCodeLine{131         S(3) = 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(1, 2);}
\DoxyCodeLine{132         S(4) = 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(0, 2);}
\DoxyCodeLine{133         S(5) = 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(0, 1);}
\DoxyCodeLine{134         \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{135       \}}
\DoxyCodeLine{136     \}}
\DoxyCodeLine{137   \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{147   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{148   \textcolor{keyword}{auto} \mbox{\hyperlink{a01634_aacf24b92643f54607e96cf323723f061}{tangentModuliImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& \textcolor{comment}{/* E */})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{149     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{150     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{151       \mbox{\hyperlink{a01634_acd3ff90a473ab0f184c04ff710f0640b}{MaterialTensor}} moduli;}
\DoxyCodeLine{152       moduli = materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * \mbox{\hyperlink{a00407_gadb08b6f9cc40847b70286dc314a23000}{identityFourthOrder}}() +}
\DoxyCodeLine{153                2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * \mbox{\hyperlink{a00407_ga1c9618ef351cd986d4f64fde7f52e860}{symmetricIdentityFourthOrder}}();}
\DoxyCodeLine{154       \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{155     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{156       Eigen::Matrix<ScalarType, 6, 6> moduli;}
\DoxyCodeLine{157       moduli.setZero();}
\DoxyCodeLine{158       moduli.template block<3, 3>(0, 0).array() = materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{159       moduli.template block<3, 3>(0, 0).diagonal().array() += 2 * materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}};}
\DoxyCodeLine{160       moduli.template block<3, 3>(3, 3).diagonal().array() = materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}};}
\DoxyCodeLine{161       \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{162     \}}
\DoxyCodeLine{163   \}}
\DoxyCodeLine{164 }
\DoxyCodeLine{170   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarTypeOther>}
\DoxyCodeLine{171   \textcolor{keyword}{auto} \mbox{\hyperlink{a01634_a7eb4b1fcf462feee557ce5a398d53ab6}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{172     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01634}{StVenantKirchhoffT<ScalarTypeOther>}}(materialParameter\_);}
\DoxyCodeLine{173   \}}
\DoxyCodeLine{174 }
\DoxyCodeLine{175 \textcolor{keyword}{private}:}
\DoxyCodeLine{176   \mbox{\hyperlink{a01634_a69400b816844f93fc27adeab860b8a47}{MaterialParameters}} materialParameter\_;}
\DoxyCodeLine{177 \};}
\DoxyCodeLine{178 }
\DoxyCodeLine{182 \textcolor{keyword}{using }\mbox{\hyperlink{a01634}{StVenantKirchhoff}} = \mbox{\hyperlink{a01634}{StVenantKirchhoffT<double>}};}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \} \textcolor{comment}{// namespace Ikarus::Materials}}

\end{DoxyCode}
