\hypertarget{a03074_source}{}\doxysection{finiteelements/mechanics/materials/hyperelastic/deviatoric/interface.hh}
\label{a03074_source}\index{interface.hh@{interface.hh}}
\mbox{\hyperlink{a03074}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2025 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <dune/common/float\_cmp.hh>}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a03098}{ikarus/finiteelements/mechanics/materials/hyperelastic/concepts.hh}}>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00032}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00422}{Ikarus::Materials}} \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{34 \textcolor{keyword}{template} <Concepts::DeviatoricFunction DF>}
\DoxyCodeLine{35 \textcolor{keyword}{struct }\mbox{\hyperlink{a01550}{Deviatoric}}}
\DoxyCodeLine{36 \{}
\DoxyCodeLine{37   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_a38cab1f899530467307c99a72f237d17}{ScalarType}} = \textcolor{keyword}{typename} DF::ScalarType;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{40   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_ab8aa2db12ce7d3afc4747f79c79e9faa}{PrincipalStretches}} = \textcolor{keyword}{typename} DF::template \mbox{\hyperlink{a01550_ab8aa2db12ce7d3afc4747f79c79e9faa}{PrincipalStretches<ST>}};}
\DoxyCodeLine{41   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_ab817946694e0dc1974210eea91cbf96b}{MaterialParameters}} = \textcolor{keyword}{typename} DF::MaterialParameters;}
\DoxyCodeLine{42 }
\DoxyCodeLine{43   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_a73db4e53efccd36416b6d4a1b37c7c43}{DeviatoricFunction}} = DF;}
\DoxyCodeLine{44 }
\DoxyCodeLine{45   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{46   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_ae39ea60042e5b2e18024bdebcbfb36e0}{FirstDerivative}} = \textcolor{keyword}{typename} DF::template \mbox{\hyperlink{a01550_ae39ea60042e5b2e18024bdebcbfb36e0}{FirstDerivative<ST>}};}
\DoxyCodeLine{47   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{48   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_ae522d172ff6190f587473adc1fa217a2}{SecondDerivative}} = \textcolor{keyword}{typename} DF::template \mbox{\hyperlink{a01550_ae522d172ff6190f587473adc1fa217a2}{SecondDerivative<ST>}};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01550_aaa5d108356815504eee15c738a129d5c}{dim}} = 3;}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{53   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_aa7ab0165103960b1a03b00af38f220d4}{StressMatrix}} = Eigen::Vector<ST, dim>;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{56   \textcolor{keyword}{using }\mbox{\hyperlink{a01550_af28dc8e5bb910a18c71849f668fce83c}{MaterialTensor}} = Eigen::TensorFixedSize<ST, Eigen::Sizes<dim, dim, dim, dim>>;}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keyword}{static} std::string \mbox{\hyperlink{a01550_a9501b06a18d4fcb2c5fbfb313288ff83}{name}}() noexcept \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Deviatoric function: "{}} + DF::name(); \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \mbox{\hyperlink{a01550_aff8750bf60731c60d8c7e8af0f4a964e}{Deviatoric}}(\textcolor{keyword}{const} DF df)}
\DoxyCodeLine{61       : deviatoricFunction\_\{df\} \{\}}
\DoxyCodeLine{62 }
\DoxyCodeLine{66   \textcolor{keyword}{const} \mbox{\hyperlink{a01550_ab817946694e0dc1974210eea91cbf96b}{MaterialParameters}} \mbox{\hyperlink{a01550_a4b4214905f9caf9d6ddc93590f9d2711}{materialParameters}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} deviatoricFunction\_.materialParametersImpl(); \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{76   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{77   ST \mbox{\hyperlink{a01550_adbd84a167004698fa848ab487f25aa74}{storedEnergy}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01550_ab8aa2db12ce7d3afc4747f79c79e9faa}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{78     \textcolor{keywordflow}{return} deviatoricFunction\_.storedEnergyImpl(lambda);}
\DoxyCodeLine{79   \};}
\DoxyCodeLine{80 }
\DoxyCodeLine{88   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{89   \mbox{\hyperlink{a01550_aa7ab0165103960b1a03b00af38f220d4}{StressMatrix<ST>}} \mbox{\hyperlink{a01550_a59cf01a7f01b2b13a689da4104925e0b}{stresses}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01550_ab8aa2db12ce7d3afc4747f79c79e9faa}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{90     \textcolor{keyword}{auto} dWdLambda = deviatoricFunction\_.firstDerivativeImpl(lambda);}
\DoxyCodeLine{91     \textcolor{keywordflow}{return} (dWdLambda.array() / lambda.array()).eval();}
\DoxyCodeLine{92   \}}
\DoxyCodeLine{93 }
\DoxyCodeLine{102   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{103   \mbox{\hyperlink{a01550_af28dc8e5bb910a18c71849f668fce83c}{MaterialTensor<ST>}} \mbox{\hyperlink{a01550_a7447e1f608c66e9d68ccc7038539ccba}{tangentModuli}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01550_ab8aa2db12ce7d3afc4747f79c79e9faa}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{104     \textcolor{keyword}{auto} S  = \mbox{\hyperlink{a01550_a59cf01a7f01b2b13a689da4104925e0b}{stresses}}(lambda);}
\DoxyCodeLine{105     \textcolor{keyword}{auto} dS = deviatoricFunction\_.secondDerivativeImpl(lambda);}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{keyword}{auto} L = \mbox{\hyperlink{a01550_af28dc8e5bb910a18c71849f668fce83c}{MaterialTensor<ST>}}\{\};}
\DoxyCodeLine{108     L.setZero();}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} i : dimensionRange())}
\DoxyCodeLine{111       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} k : dimensionRange())}
\DoxyCodeLine{112         L(i, i, k, k) = 1.0 / (lambda(i) * lambda(k)) * dS(i, k);}
\DoxyCodeLine{113 }
\DoxyCodeLine{114     Eigen::ArrayXd lambdaSquared = lambda.array().square();}
\DoxyCodeLine{115     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} i : dimensionRange())}
\DoxyCodeLine{116       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} k : dimensionRange())}
\DoxyCodeLine{117         \textcolor{keywordflow}{if} (i != k) \{}
\DoxyCodeLine{118           \textcolor{keywordflow}{if} (Dune::FloatCmp::eq(lambda(i), lambda(k), 1e-\/8))}
\DoxyCodeLine{119             L(i, k, i, k) = 0.5 * (L(i, i, i, i) -\/ L(i, i, k, k));}
\DoxyCodeLine{120           \textcolor{keywordflow}{else}}
\DoxyCodeLine{121             L(i, k, i, k) += (S(i) -\/ S(k)) / (lambdaSquared(i) -\/ lambdaSquared(k));}
\DoxyCodeLine{122         \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{keywordflow}{return} L;}
\DoxyCodeLine{125   \};}
\DoxyCodeLine{126 }
\DoxyCodeLine{132   \textcolor{keyword}{template} <\textcolor{keyword}{typename} STO>}
\DoxyCodeLine{133   \textcolor{keyword}{auto} \mbox{\hyperlink{a01550_a8a1cd371dc2896c817586aa715e66969}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{134     \textcolor{keyword}{auto} reboundDF = deviatoricFunction\_.template rebind<STO>();}
\DoxyCodeLine{135     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01550}{Deviatoric}}<\textcolor{keyword}{decltype}(reboundDF)>\{reboundDF\};}
\DoxyCodeLine{136   \}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{keyword}{private}:}
\DoxyCodeLine{139   DF deviatoricFunction\_;}
\DoxyCodeLine{140 }
\DoxyCodeLine{141   \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} dimensionRange() \{ \textcolor{keywordflow}{return} Dune::range(\mbox{\hyperlink{a01550_aaa5d108356815504eee15c738a129d5c}{dim}}); \}}
\DoxyCodeLine{142 \};}
\DoxyCodeLine{143 \} \textcolor{comment}{// namespace Ikarus::Materials}}

\end{DoxyCode}
