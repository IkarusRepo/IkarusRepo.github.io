\hypertarget{a00245_source}{}\doxysection{gent.\+hh}
\label{a00245_source}\index{gent.hh@{gent.hh}}
\mbox{\hyperlink{a00245}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2025 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00260}{ikarus/finiteelements/mechanics/materials/hyperelastic/deviatoric/deviatoricinvariants.hh}}>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00275}{ikarus/finiteelements/mechanics/materials/materialhelpers.hh}}>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00233}{ikarus/finiteelements/mechanics/materials/tags.hh}}>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00032}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00411}{Ikarus}} \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{20 \textcolor{keyword}{struct }\mbox{\hyperlink{a01542}{GentMatParameters}}}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01542_a419ca66b8ac1231091d83637752c7e9b}{mu}}; }
\DoxyCodeLine{23   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01542_ad4483a8c3f8b72a934baeee80bb4c3be}{Jm}}; }
\DoxyCodeLine{24 \};}
\DoxyCodeLine{25 \} \textcolor{comment}{// namespace Ikarus}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00422}{Ikarus::Materials}} \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{52 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST\_>}
\DoxyCodeLine{53 \textcolor{keyword}{struct }\mbox{\hyperlink{a01546}{GentT}}}
\DoxyCodeLine{54 \{}
\DoxyCodeLine{55   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01546_ad494a4eb399bf1ee960cab0ccedc878c}{dim}} = 3;}
\DoxyCodeLine{56   \textcolor{keyword}{using }\mbox{\hyperlink{a01546_a006a1668e5050f802f427ffd2519ad8c}{ScalarType}}         = ST\_;}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{59   \textcolor{keyword}{using }\mbox{\hyperlink{a01546_af3f9b5e36aca41ecfa7e05517e10ee50}{PrincipalStretches}} = Eigen::Vector<ST, 3>;}
\DoxyCodeLine{60 }
\DoxyCodeLine{61   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{62   \textcolor{keyword}{using }\mbox{\hyperlink{a01546_a9303be9dbb2da94477af2679daf51d5a}{Invariants}} = \mbox{\hyperlink{a01546_af3f9b5e36aca41ecfa7e05517e10ee50}{PrincipalStretches<ST>}};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{65   \textcolor{keyword}{using }\mbox{\hyperlink{a01546_a232189b3d21d46e2c5f407f90d7f1ab6}{FirstDerivative}} = Eigen::Vector<ST, dim>;}
\DoxyCodeLine{66   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{67   \textcolor{keyword}{using }\mbox{\hyperlink{a01546_aba1efc2e1e4c478fb5c8b1cf62d85971}{SecondDerivative}} = Eigen::Matrix<ST, dim, dim>;}
\DoxyCodeLine{68 }
\DoxyCodeLine{69   \textcolor{keyword}{using }\mbox{\hyperlink{a01542}{MaterialParameters}} = \mbox{\hyperlink{a01542}{GentMatParameters}};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01546_a025c9024a87a6da081bb2698a6980544}{stretchTag}} = \mbox{\hyperlink{a00411_aec3d3c4647af5c01e1bf18637b3c89feaae6dc167631992e1312a197d5c3c39f8}{PrincipalStretchTags::deviatoric}};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keyword}{static} std::string \mbox{\hyperlink{a01546_a6ab32a23370f0a8b3b266e7da822b09d}{name}}() noexcept \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Gent"{}}; \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{81   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01546_a394ec60a1918b0285b925c729dcb3be8}{GentT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01542}{MaterialParameters}}\& matPar)}
\DoxyCodeLine{82       : matPar\_\{matPar\} \{\}}
\DoxyCodeLine{83 }
\DoxyCodeLine{87   \mbox{\hyperlink{a01542}{MaterialParameters}} \mbox{\hyperlink{a01546_a8248240a321b3c45a080ed0c20169ddd}{materialParametersImpl}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} matPar\_; \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{97   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{98   ST \mbox{\hyperlink{a01546_a68ae9586f841b9b0172452f539c8b9ee}{storedEnergyImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01546_af3f9b5e36aca41ecfa7e05517e10ee50}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{99     \textcolor{keyword}{const} \mbox{\hyperlink{a01546_a9303be9dbb2da94477af2679daf51d5a}{Invariants<ST>}}\& invariants = Impl::invariants(lambda);}
\DoxyCodeLine{100     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& devInvariants        = \mbox{\hyperlink{a01538}{DeviatoricInvariants<PrincipalStretches<ST>}}>(lambda);}
\DoxyCodeLine{101     \textcolor{keyword}{const} \textcolor{keyword}{auto} W1                    = devInvariants.\mbox{\hyperlink{a01538_a9c016a61bba2d581b57c0f373a7f822c}{value}}()[0];}
\DoxyCodeLine{102     checkJm(W1);}
\DoxyCodeLine{103     \textcolor{keywordflow}{return} -\/(matPar\_.\mbox{\hyperlink{a01542_a419ca66b8ac1231091d83637752c7e9b}{mu}} / 2.0) * matPar\_.\mbox{\hyperlink{a01542_ad4483a8c3f8b72a934baeee80bb4c3be}{Jm}} * log(1.0 -\/ ((W1 -\/ 3.0) / matPar\_.\mbox{\hyperlink{a01542_ad4483a8c3f8b72a934baeee80bb4c3be}{Jm}}));}
\DoxyCodeLine{104   \}}
\DoxyCodeLine{105 }
\DoxyCodeLine{113   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{114   \mbox{\hyperlink{a01546_a232189b3d21d46e2c5f407f90d7f1ab6}{FirstDerivative<ST>}} \mbox{\hyperlink{a01546_ae528fcf9c0dd959467cbbc22b20c42e4}{firstDerivativeImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01546_af3f9b5e36aca41ecfa7e05517e10ee50}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{115     \textcolor{keyword}{const} \mbox{\hyperlink{a01546_a9303be9dbb2da94477af2679daf51d5a}{Invariants<ST>}}\& invariants = Impl::invariants(lambda);}
\DoxyCodeLine{116     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& devInvariants        = \mbox{\hyperlink{a01538}{DeviatoricInvariants<PrincipalStretches<ST>}}>(lambda);}
\DoxyCodeLine{117     \textcolor{keyword}{const} \textcolor{keyword}{auto} W1                    = devInvariants.\mbox{\hyperlink{a01538_a9c016a61bba2d581b57c0f373a7f822c}{value}}()[0];}
\DoxyCodeLine{118     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dW1dLambda           = devInvariants.firstDerivative().first;}
\DoxyCodeLine{119     \textcolor{keyword}{const} \textcolor{keyword}{auto} mu                    = matPar\_.\mbox{\hyperlink{a01542_a419ca66b8ac1231091d83637752c7e9b}{mu}};}
\DoxyCodeLine{120     \textcolor{keyword}{const} \textcolor{keyword}{auto} Jm                    = matPar\_.\mbox{\hyperlink{a01542_ad4483a8c3f8b72a934baeee80bb4c3be}{Jm}};}
\DoxyCodeLine{121     checkJm(W1);}
\DoxyCodeLine{122 }
\DoxyCodeLine{123     \mbox{\hyperlink{a01546_a232189b3d21d46e2c5f407f90d7f1ab6}{FirstDerivative<ST>}} dWdLambda = (mu * dW1dLambda * Jm) / (2.0 * (Jm -\/ W1) + 6.0);}
\DoxyCodeLine{124 }
\DoxyCodeLine{125     \textcolor{keywordflow}{return} dWdLambda;}
\DoxyCodeLine{126   \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{135   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{136   \mbox{\hyperlink{a01546_aba1efc2e1e4c478fb5c8b1cf62d85971}{SecondDerivative<ST>}} \mbox{\hyperlink{a01546_a2a7ac85d8340e3153acad2242485b087}{secondDerivativeImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01546_af3f9b5e36aca41ecfa7e05517e10ee50}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{137     \textcolor{keyword}{const} \mbox{\hyperlink{a01546_a9303be9dbb2da94477af2679daf51d5a}{Invariants<ST>}}\& invariants = Impl::invariants(lambda);}
\DoxyCodeLine{138     \textcolor{keyword}{auto} dS                          = \mbox{\hyperlink{a01546_aba1efc2e1e4c478fb5c8b1cf62d85971}{SecondDerivative<ST>::Zero}}().eval();}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& devInvariants = \mbox{\hyperlink{a01538}{DeviatoricInvariants<PrincipalStretches<ST>}}>(lambda);}
\DoxyCodeLine{141     \textcolor{keyword}{const} \textcolor{keyword}{auto} W1             = devInvariants.\mbox{\hyperlink{a01538_a9c016a61bba2d581b57c0f373a7f822c}{value}}()[0];}
\DoxyCodeLine{142     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dW1dLambda    = devInvariants.firstDerivative().first;}
\DoxyCodeLine{143     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddW1dLambda   = devInvariants.secondDerivative().first;}
\DoxyCodeLine{144     \textcolor{keyword}{const} \textcolor{keyword}{auto} mu             = matPar\_.\mbox{\hyperlink{a01542_a419ca66b8ac1231091d83637752c7e9b}{mu}};}
\DoxyCodeLine{145     \textcolor{keyword}{const} \textcolor{keyword}{auto} Jm             = matPar\_.\mbox{\hyperlink{a01542_ad4483a8c3f8b72a934baeee80bb4c3be}{Jm}};}
\DoxyCodeLine{146     checkJm(W1);}
\DoxyCodeLine{147 }
\DoxyCodeLine{148     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} i : dimensionRange())}
\DoxyCodeLine{149       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} j : dimensionRange()) \{}
\DoxyCodeLine{150         \textcolor{keyword}{auto} factor1 = 1.0 -\/ ((W1 -\/ 3.0) / Jm);}
\DoxyCodeLine{151         dS(i, j) += (mu / (2.0 * factor1)) * (ddW1dLambda(i, j) + (dW1dLambda[i] * dW1dLambda[j] / (factor1 * Jm)));}
\DoxyCodeLine{152         \textcolor{keywordflow}{if} (i == j)}
\DoxyCodeLine{153           dS(i, j) -\/= (mu / (2.0 * lambda[i] * factor1)) * dW1dLambda[i];}
\DoxyCodeLine{154       \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156     \textcolor{keywordflow}{return} dS;}
\DoxyCodeLine{157   \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{164   \textcolor{keyword}{template} <\textcolor{keyword}{typename} STO>}
\DoxyCodeLine{165   \textcolor{keyword}{auto} \mbox{\hyperlink{a01546_a5d96044e7cd8acc2cb3d1aeaf4bb24d7}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{166     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01546}{GentT<STO>}}(matPar\_);}
\DoxyCodeLine{167   \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169 \textcolor{keyword}{private}:}
\DoxyCodeLine{170   \mbox{\hyperlink{a01546_affe89a380b23ceaba49703324aa24ddb}{MaterialParameters}} matPar\_;}
\DoxyCodeLine{171 }
\DoxyCodeLine{172   \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} dimensionRange() \{ \textcolor{keywordflow}{return} Dune::range(\mbox{\hyperlink{a01546_ad494a4eb399bf1ee960cab0ccedc878c}{dim}}); \}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174   \textcolor{keywordtype}{void} checkJm(\mbox{\hyperlink{a01546_a006a1668e5050f802f427ffd2519ad8c}{ScalarType}} W1)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{175     \textcolor{keywordflow}{if} (Dune::FloatCmp::le(matPar\_.Jm, \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(W1) -\/ 3.0, 1e-\/14))}
\DoxyCodeLine{176       DUNE\_THROW(Dune::InvalidStateException, \textcolor{stringliteral}{"{}The material parameter Jm should be greater than (W1 -\/ 3)"{}});}
\DoxyCodeLine{177   \}}
\DoxyCodeLine{178 \};}
\DoxyCodeLine{179 }
\DoxyCodeLine{183 \textcolor{keyword}{using }\mbox{\hyperlink{a01546}{Gent}} = \mbox{\hyperlink{a01546}{GentT<double>}};}
\DoxyCodeLine{184 }
\DoxyCodeLine{185 \} \textcolor{comment}{// namespace Ikarus::Materials}}

\end{DoxyCode}
