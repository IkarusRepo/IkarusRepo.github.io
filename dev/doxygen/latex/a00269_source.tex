\hypertarget{a00269_source}{}\doxysection{neohooke.\+hh}
\label{a00269_source}\index{neohooke.hh@{neohooke.hh}}
\mbox{\hyperlink{a00269}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2025 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a03068}{ikarus/finiteelements/mechanics/materials/interface.hh}}>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00275}{ikarus/finiteelements/mechanics/materials/materialhelpers.hh}}>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00032}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00422}{Ikarus::Materials}} \{}
\DoxyCodeLine{17 }
\DoxyCodeLine{36 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{37 \textcolor{keyword}{struct }\mbox{\hyperlink{a01566}{NeoHookeT}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01622}{Material}}<NeoHookeT<ST>>}
\DoxyCodeLine{38 \{}
\DoxyCodeLine{39   \textcolor{keyword}{using }\mbox{\hyperlink{a01566_a3dba82ed47fda4d4552755130694cf45}{ScalarType}}         = ST;}
\DoxyCodeLine{40   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01566_a5780894401186bf48c3de6a11e2665f5}{dim}} = 3;}
\DoxyCodeLine{41   \textcolor{keyword}{using }\mbox{\hyperlink{a01566_ab439ece776e63f03eb2fe4d330353196}{StrainMatrix}}       = Eigen::Matrix<ScalarType, dim, dim>;}
\DoxyCodeLine{42   \textcolor{keyword}{using }\mbox{\hyperlink{a01566_a3f1a8232d382de393877cf5886a75c89}{StressMatrix}}       = \mbox{\hyperlink{a01566_ab439ece776e63f03eb2fe4d330353196}{StrainMatrix}};}
\DoxyCodeLine{43   \textcolor{keyword}{using }\mbox{\hyperlink{a01566_a83c093e1b1475f4fe70067b55331233c}{MaterialTensor}}     = Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<dim, dim, dim, dim>>;}
\DoxyCodeLine{44 }
\DoxyCodeLine{45   \textcolor{keyword}{using }\mbox{\hyperlink{a01710}{MaterialParameters}} = \mbox{\hyperlink{a01710}{LamesFirstParameterAndShearModulus}};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01566_aa5a10299ec0ec07b2f7b8d6d33da7f45}{strainTag}}              = \mbox{\hyperlink{a00400_ggacef1e451de1a99845c59d7391064fb8faea40a9960a7a89c4f366beeab85d07d2}{StrainTags::rightCauchyGreenTensor}};}
\DoxyCodeLine{48   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01566_a8b3890e8fcee130fff7d144ba5f245b0}{stressTag}}              = \mbox{\hyperlink{a00400_gga70b4ce43c53cc5e949d49919f437501eab13248d68ac5516c015337b68346fc21}{StressTags::PK2}};}
\DoxyCodeLine{49   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01566_af214c69a1e904c098bc647c3786518d8}{tangentModuliTag}}       = \mbox{\hyperlink{a00400_gga05ac785124262c1e323d2f937d520a1bad92a8333dd3ccb895cc65f7455b71206}{TangentModuliTags::Material}};}
\DoxyCodeLine{50   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01566_ad54b9a96b0184f30eca97121e902a753}{energyAcceptsVoigt}}     = \textcolor{keyword}{false};}
\DoxyCodeLine{51   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01566_a79c4e41a110784e9d6aac5006ce08479}{stressToVoigt}}          = \textcolor{keyword}{false};}
\DoxyCodeLine{52   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01566_a82a588fd6e602b10831f25dacaa23239}{stressAcceptsVoigt}}     = \textcolor{keyword}{false};}
\DoxyCodeLine{53   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01566_a73a0152530e9583450136710d9a15593}{moduliToVoigt}}          = \textcolor{keyword}{false};}
\DoxyCodeLine{54   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01566_a4887a57a3267c6fa57eff665fa6a418e}{moduliAcceptsVoigt}}     = \textcolor{keyword}{false};}
\DoxyCodeLine{55   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{double} \mbox{\hyperlink{a01566_adcaf4114163835af544b5f626889629c}{derivativeFactorImpl}} = 2;}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keyword}{static} std::string \mbox{\hyperlink{a01566_ab7409557fd6b8664c9a17a74ed429221}{nameImpl}}() noexcept \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}NeoHooke"{}}; \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{63   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01566_a99479e4c203b411bbda554d36c6cba3d}{NeoHookeT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01710}{MaterialParameters}}\& mpt)}
\DoxyCodeLine{64       : materialParameter\_\{mpt\} \{\}}
\DoxyCodeLine{65 }
\DoxyCodeLine{69   \mbox{\hyperlink{a01710}{MaterialParameters}} \mbox{\hyperlink{a01566_a4576e0e649587e2bc050395b423bc76d}{materialParametersImpl}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} materialParameter\_; \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{77   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{78   \mbox{\hyperlink{a01566_a3dba82ed47fda4d4552755130694cf45}{ScalarType}} \mbox{\hyperlink{a01566_a8ff14eaeedc7a42428bb3a5236c60fdf}{storedEnergyImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{79     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{80     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{81       \textcolor{keyword}{const} \textcolor{keyword}{auto} traceC = C.trace();}
\DoxyCodeLine{82       \textcolor{keyword}{const} \textcolor{keyword}{auto} detC   = C.determinant();}
\DoxyCodeLine{83       Impl::checkPositiveOrAbort(detC);}
\DoxyCodeLine{84       \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(detC));}
\DoxyCodeLine{85       \textcolor{keywordflow}{return} materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} / 2.0 * (traceC -\/ 3 -\/ 2 * logdetF) +}
\DoxyCodeLine{86              materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / 2.0 * logdetF * logdetF;}
\DoxyCodeLine{87     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{88       \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}},}
\DoxyCodeLine{89                     \textcolor{stringliteral}{"{}NeoHooke energy can only be called with a matrix and not a vector in Voigt notation"{}});}
\DoxyCodeLine{90   \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{99   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{100   \mbox{\hyperlink{a01566_a3f1a8232d382de393877cf5886a75c89}{StressMatrix}} \mbox{\hyperlink{a01566_a9c9a397c7c951d33adc8887f795a87c2}{stressesImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{101     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{102     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{103       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{104         \textcolor{keyword}{const} \textcolor{keyword}{auto} detC = C.determinant();}
\DoxyCodeLine{105         Impl::checkPositiveOrAbort(detC);}
\DoxyCodeLine{106         \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(detC));}
\DoxyCodeLine{107         \textcolor{keyword}{const} \textcolor{keyword}{auto} invC    = C.inverse().eval();}
\DoxyCodeLine{108         \textcolor{keywordflow}{return} (materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} * (StrainMatrix::Identity() -\/ invC) + materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * logdetF * invC)}
\DoxyCodeLine{109             .eval();}
\DoxyCodeLine{110       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{111         \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{a02096}{Concepts::EigenVector<Derived>}},}
\DoxyCodeLine{112                       \textcolor{stringliteral}{"{}NeoHooke can only be called with a matrix and not a vector in Voigt notation"{}});}
\DoxyCodeLine{113     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{114       \textcolor{keyword}{static\_assert}(voigt == \textcolor{keyword}{false}, \textcolor{stringliteral}{"{}NeoHooke does not support returning stresses in Voigt notation"{}});}
\DoxyCodeLine{115   \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{124   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{125   \mbox{\hyperlink{a01566_a83c093e1b1475f4fe70067b55331233c}{MaterialTensor}} \mbox{\hyperlink{a01566_a92c9a4a1de6a303ade0393299b587657}{tangentModuliImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{126     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{127     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{128       \textcolor{keyword}{const} \textcolor{keyword}{auto} invC = C.inverse().eval();}
\DoxyCodeLine{129       \textcolor{keyword}{const} \textcolor{keyword}{auto} detC = C.determinant();}
\DoxyCodeLine{130       Impl::checkPositiveOrAbort(detC);}
\DoxyCodeLine{131       \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(detC));}
\DoxyCodeLine{132       \textcolor{keyword}{const} \textcolor{keyword}{auto} CTinv   = \mbox{\hyperlink{a00407_ga5cfd9d098384fb067d897b3c0499b447}{tensorView}}(invC, std::array<Eigen::Index, 2>(\{3, 3\}));}
\DoxyCodeLine{133 }
\DoxyCodeLine{134       \mbox{\hyperlink{a01566_a83c093e1b1475f4fe70067b55331233c}{MaterialTensor}} moduli = (materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * \mbox{\hyperlink{a00407_gab2cea9ac847cc3635812467c9d96ceb4}{dyadic}}(CTinv, CTinv) +}
\DoxyCodeLine{135                                2 * (materialParameter\_.\mbox{\hyperlink{a01710_a3558ad06d2a831f0d412d76956d516f8}{mu}} -\/ materialParameter\_.\mbox{\hyperlink{a01710_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * logdetF) *}
\DoxyCodeLine{136                                    \mbox{\hyperlink{a00407_gaea03dbfcd8f85ef7af004c7e09244aa9}{symTwoSlots}}(\mbox{\hyperlink{a00407_ga8fa2b440586483c1ee0f9b90b9081da2}{fourthOrderIKJL}}(invC, invC), \{2, 3\}))}
\DoxyCodeLine{137                                   .eval();}
\DoxyCodeLine{138       \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{139     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{140       \textcolor{keyword}{static\_assert}(voigt == \textcolor{keyword}{false}, \textcolor{stringliteral}{"{}NeoHooke does not support returning tangent moduli in Voigt notation"{}});}
\DoxyCodeLine{141   \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{148   \textcolor{keyword}{template} <\textcolor{keyword}{typename} STO>}
\DoxyCodeLine{149   \textcolor{keyword}{auto} \mbox{\hyperlink{a01566_a2b1ec4bb9f62bdcfbfb9c0d43a2e3955}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{150     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01566}{NeoHookeT<STO>}}(materialParameter\_);}
\DoxyCodeLine{151   \}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 \textcolor{keyword}{private}:}
\DoxyCodeLine{154   \mbox{\hyperlink{a01566_adaf344b4b732a57b259f6bbfbe24b40a}{MaterialParameters}} materialParameter\_;}
\DoxyCodeLine{155 \};}
\DoxyCodeLine{156 }
\DoxyCodeLine{160 \textcolor{keyword}{using }\mbox{\hyperlink{a01566}{NeoHooke}} = \mbox{\hyperlink{a01566}{NeoHookeT<double>}};}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \} \textcolor{comment}{// namespace Ikarus::Materials}}

\end{DoxyCode}
