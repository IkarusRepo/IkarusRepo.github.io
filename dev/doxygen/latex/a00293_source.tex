\hypertarget{a00293_source}{}\doxysection{svk.\+hh}
\label{a00293_source}\index{svk.hh@{svk.hh}}
\mbox{\hyperlink{a00293}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a02842}{ikarus/finiteelements/mechanics/materials/interface.hh}}>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00008}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00384}{Ikarus}} \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{35 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{36 \textcolor{keyword}{struct }\mbox{\hyperlink{a01504}{StVenantKirchhoffT}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01492}{Material}}<StVenantKirchhoffT<ST>>}
\DoxyCodeLine{37 \{}
\DoxyCodeLine{38   \textcolor{keyword}{using }\mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}}                    = ST;}
\DoxyCodeLine{39   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01504_a27cdc2b4a8003b052ba251302d378dec}{worldDimension}} = 3;}
\DoxyCodeLine{40   \textcolor{keyword}{using }\mbox{\hyperlink{a01504_a42c1563dfce8b0de48b2e5362e2f29d9}{StrainMatrix}}                  = Eigen::Matrix<ScalarType, worldDimension, worldDimension>;}
\DoxyCodeLine{41   \textcolor{keyword}{using }\mbox{\hyperlink{a01504_ae797d6a15d39782d110db78dde63a927}{StressMatrix}}                  = \mbox{\hyperlink{a01504_a42c1563dfce8b0de48b2e5362e2f29d9}{StrainMatrix}};}
\DoxyCodeLine{42   \textcolor{keyword}{using }\mbox{\hyperlink{a01584}{MaterialParameters}}            = \mbox{\hyperlink{a01584}{LamesFirstParameterAndShearModulus}};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01504_a6b936df1cd8db75a9c526663adfc1235}{strainTag}}              = \mbox{\hyperlink{a00373_ggacef1e451de1a99845c59d7391064fb8faca3f1e4bb21fd00a3d29c5d8aff8e11e}{StrainTags::greenLagrangian}};}
\DoxyCodeLine{45   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01504_abb8aa05d14e025ae5030f11255e19bd1}{stressTag}}              = \mbox{\hyperlink{a00373_gga70b4ce43c53cc5e949d49919f437501eab13248d68ac5516c015337b68346fc21}{StressTags::PK2}};}
\DoxyCodeLine{46   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01504_adc79568930df223ccc520f5522f3ace6}{tangentModuliTag}}       = \mbox{\hyperlink{a00373_gga05ac785124262c1e323d2f937d520a1bad92a8333dd3ccb895cc65f7455b71206}{TangentModuliTags::Material}};}
\DoxyCodeLine{47   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01504_ae416f653e4acd68f9f11a5144027f391}{energyAcceptsVoigt}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{48   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01504_aa4740919dc11418d8ac0b69107065302}{stressToVoigt}}          = \textcolor{keyword}{true};}
\DoxyCodeLine{49   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01504_a405931c9031f904bdbc8e92df983aa30}{stressAcceptsVoigt}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{50   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01504_a5d027dc6338b0b3a476e69502a93acb8}{moduliToVoigt}}          = \textcolor{keyword}{true};}
\DoxyCodeLine{51   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01504_a320453d35c1b9aec5c40ea828f2073f0}{moduliAcceptsVoigt}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{52   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{double} \mbox{\hyperlink{a01504_a4049ed302cd83ed2f5ee4fbb85d11625}{derivativeFactorImpl}} = 1;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keyword}{static} std::string \mbox{\hyperlink{a01504_aa7cffbbcaeac7acef5f448c59e42003c}{nameImpl}}() \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}StVenantKirchhoff"{}}; \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{60   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01504_a9b9f6d4e201edc8b9ac1d370d10adb36}{StVenantKirchhoffT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01584}{MaterialParameters}}\& mpt)}
\DoxyCodeLine{61       : materialParameter\_\{mpt\} \{\}}
\DoxyCodeLine{62 }
\DoxyCodeLine{66   \mbox{\hyperlink{a01584}{MaterialParameters}} \mbox{\hyperlink{a01504_a4dc68a6c9bc8e79803e8684102f5b0f4}{materialParametersImpl}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} materialParameter\_; \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{74   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{75   \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}} \mbox{\hyperlink{a01504_a12718b6f404b7ab246986018bd2c50f9}{storedEnergyImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& E)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{76     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{77     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a01956}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{78       \textcolor{keyword}{const} \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}} traceE = E.template segment<3>(0).sum();}
\DoxyCodeLine{79       \textcolor{keyword}{const} \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}} squaredNorm =}
\DoxyCodeLine{80           E.template segment<3>(0).squaredNorm() + E.template segment<3>(3).squaredNorm() / \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}}(2.0);}
\DoxyCodeLine{81       \textcolor{keywordflow}{return} materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}}(2.0) * traceE * traceE + materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * squaredNorm;}
\DoxyCodeLine{82     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{83       \textcolor{keyword}{const} \textcolor{keyword}{auto} traceE = E.trace();}
\DoxyCodeLine{84       \textcolor{keywordflow}{return} materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}}(2.0) * traceE * traceE + materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E.squaredNorm();}
\DoxyCodeLine{85     \}}
\DoxyCodeLine{86   \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{95   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{96   \textcolor{keyword}{auto} \mbox{\hyperlink{a01504_a81a6d9cbf7ce96f9f5ca5380e8effb2c}{stressesImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& E)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{97     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<\textcolor{keyword}{decltype}(E.eval())>);}
\DoxyCodeLine{98     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ed = E.derived();}
\DoxyCodeLine{99     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{100       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a01956}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{101         \textcolor{keyword}{static\_assert}(Concepts::EigenVector6<Derived>);}
\DoxyCodeLine{102         Eigen::Matrix<ScalarType, 3, 3> S;}
\DoxyCodeLine{103         \textcolor{keyword}{const} \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}} traceE = Ed.template segment<3>(0).sum();}
\DoxyCodeLine{104         S.diagonal().array() =}
\DoxyCodeLine{105             materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * traceE + 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed.template segment<3>(0).array();}
\DoxyCodeLine{106         S(1, 2) = S(2, 1) = materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(3);}
\DoxyCodeLine{107         S(0, 2) = S(2, 0) = materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(4);}
\DoxyCodeLine{108         S(0, 1) = S(1, 0) = materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(5); \textcolor{comment}{// no two since E voigt has 2* on off-\/diagonal terms}}
\DoxyCodeLine{109         \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{110       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{111         \textcolor{keyword}{static\_assert}(Concepts::EigenMatrix33<Derived>);}
\DoxyCodeLine{112         \textcolor{keywordflow}{return} (materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * Ed.trace() * StrainMatrix::Identity() + 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed)}
\DoxyCodeLine{113             .eval();}
\DoxyCodeLine{114       \}}
\DoxyCodeLine{115     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{116       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a01956}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{117         \textcolor{keyword}{static\_assert}(Concepts::EigenVector6<Derived>);}
\DoxyCodeLine{118         Eigen::Matrix<ScalarType, 6, 1> S;}
\DoxyCodeLine{119         \textcolor{keyword}{const} \mbox{\hyperlink{a01504_af2e2dfcfb355c5eeb456de03cbfe7f47}{ScalarType}} traceE          = Ed.template segment<3>(0).sum();}
\DoxyCodeLine{120         S.template segment<3>(0).array() = traceE * materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{121         S.template segment<3>(0) += materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * 2 * Ed.template segment<3>(0);}
\DoxyCodeLine{122         S.template segment<3>(3) =}
\DoxyCodeLine{123             materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed.template segment<3>(3); \textcolor{comment}{// no two since E voigt has 2* on off-\/diagonal terms}}
\DoxyCodeLine{124         \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{125       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{126         Eigen::Matrix<ScalarType, 6, 1> S;}
\DoxyCodeLine{127         S.template segment<3>(0).array() = Ed.trace() * materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{128         S.template segment<3>(0) += 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed.diagonal();}
\DoxyCodeLine{129         S(3) = 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(1, 2);}
\DoxyCodeLine{130         S(4) = 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(0, 2);}
\DoxyCodeLine{131         S(5) = 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * Ed(0, 1);}
\DoxyCodeLine{132         \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{133       \}}
\DoxyCodeLine{134     \}}
\DoxyCodeLine{135   \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{144   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{145   \textcolor{keyword}{auto} \mbox{\hyperlink{a01504_a9cad76128962f632ae742e8769b9803e}{tangentModuliImpl}}([[maybe\_unused]] \textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& E)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{146     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{147     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{148       Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<3, 3, 3, 3>> moduli;}
\DoxyCodeLine{149       moduli = materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * \mbox{\hyperlink{a00380_gadb08b6f9cc40847b70286dc314a23000}{identityFourthOrder}}() +}
\DoxyCodeLine{150                2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}} * \mbox{\hyperlink{a00380_ga1c9618ef351cd986d4f64fde7f52e860}{symmetricIdentityFourthOrder}}();}
\DoxyCodeLine{151       \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{152     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{153       Eigen::Matrix<ScalarType, 6, 6> moduli;}
\DoxyCodeLine{154       moduli.setZero();}
\DoxyCodeLine{155       moduli.template block<3, 3>(0, 0).array() = materialParameter\_.\mbox{\hyperlink{a01584_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{156       moduli.template block<3, 3>(0, 0).diagonal().array() += 2 * materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}};}
\DoxyCodeLine{157       moduli.template block<3, 3>(3, 3).diagonal().array() = materialParameter\_.\mbox{\hyperlink{a01584_a3558ad06d2a831f0d412d76956d516f8}{mu}};}
\DoxyCodeLine{158       \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{159     \}}
\DoxyCodeLine{160   \}}
\DoxyCodeLine{161 }
\DoxyCodeLine{167   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarTypeOther>}
\DoxyCodeLine{168   \textcolor{keyword}{auto} \mbox{\hyperlink{a01504_a47a0de83c91849d44fb9dee6b10a02d9}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{169     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01504}{StVenantKirchhoffT<ScalarTypeOther>}}(materialParameter\_);}
\DoxyCodeLine{170   \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{keyword}{private}:}
\DoxyCodeLine{173   \mbox{\hyperlink{a01504_a88d0f4d640e4eb7982831f7fcf26ed00}{MaterialParameters}} materialParameter\_;}
\DoxyCodeLine{174 \};}
\DoxyCodeLine{175 }
\DoxyCodeLine{179 \textcolor{keyword}{using }\mbox{\hyperlink{a01504}{StVenantKirchhoff}} = \mbox{\hyperlink{a01504}{StVenantKirchhoffT<double>}};}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 \} \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
