\hypertarget{a00248_source}{}\doxysection{arrudaboyce.\+hh}
\label{a00248_source}\index{arrudaboyce.hh@{arrudaboyce.hh}}
\mbox{\hyperlink{a00248}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2025 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00260}{ikarus/finiteelements/mechanics/materials/hyperelastic/deviatoric/deviatoricinvariants.hh}}>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00275}{ikarus/finiteelements/mechanics/materials/materialhelpers.hh}}>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00233}{ikarus/finiteelements/mechanics/materials/tags.hh}}>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00032}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00411}{Ikarus}} \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{20 \textcolor{keyword}{struct }\mbox{\hyperlink{a01526}{ArrudaBoyceMatParameters}}}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01526_a3efa65d2dfee3e53789fb16d7815372b}{mu}};      }
\DoxyCodeLine{23   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01526_a78ad6bdab1c8f663a64abeec58d02f02}{lambdaM}}; }
\DoxyCodeLine{24 \};}
\DoxyCodeLine{25 \} \textcolor{comment}{// namespace Ikarus}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00422}{Ikarus::Materials}} \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{53 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST\_>}
\DoxyCodeLine{54 \textcolor{keyword}{struct }\mbox{\hyperlink{a01530}{ArrudaBoyceT}}}
\DoxyCodeLine{55 \{}
\DoxyCodeLine{56   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01530_a4c7f052604e0466671aa6090e41d06e6}{dim}} = 3;}
\DoxyCodeLine{57   \textcolor{keyword}{using }\mbox{\hyperlink{a01530_ae0ebdd5cb66576342876a323334edfa3}{ScalarType}}         = ST\_;}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{60   \textcolor{keyword}{using }\mbox{\hyperlink{a01530_a1285d903578f2a42247ece4214977a53}{PrincipalStretches}} = Eigen::Vector<ST, 3>;}
\DoxyCodeLine{61   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{62   \textcolor{keyword}{using }\mbox{\hyperlink{a01530_a6f6967cf124d7c86783cc01c8849f304}{Invariants}} = \mbox{\hyperlink{a01530_a1285d903578f2a42247ece4214977a53}{PrincipalStretches<ST>}};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{65   \textcolor{keyword}{using }\mbox{\hyperlink{a01530_aa8e3988e1c8d0d611fb28354e20e5fc6}{FirstDerivative}} = Eigen::Vector<ST, dim>;}
\DoxyCodeLine{66   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = ScalarType>}
\DoxyCodeLine{67   \textcolor{keyword}{using }\mbox{\hyperlink{a01530_aae064ebc679ff3aae55770774d9f2f20}{SecondDerivative}} = Eigen::Matrix<ST, dim, dim>;}
\DoxyCodeLine{68 }
\DoxyCodeLine{69   \textcolor{keyword}{using }\mbox{\hyperlink{a01526}{MaterialParameters}}      = \mbox{\hyperlink{a01526}{ArrudaBoyceMatParameters}};}
\DoxyCodeLine{70   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01530_a7054465b5882a8d6e9bfa52f1c3a49f7}{numTerms}} = 5;}
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01530_a5d82709e65ee6228bbfa1e340c9c6152}{stretchTag}} = \mbox{\hyperlink{a00411_aec3d3c4647af5c01e1bf18637b3c89feaae6dc167631992e1312a197d5c3c39f8}{PrincipalStretchTags::deviatoric}};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keyword}{static} std::string \mbox{\hyperlink{a01530_aa2e4a543775cd8f30dcb768834a8b66d}{name}}() noexcept \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}ArrudaBoyce"{}}; \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{81   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01530_a12fffa74c2d66f88cb341ef2be15c2a2}{ArrudaBoyceT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01526}{MaterialParameters}}\& matPar)}
\DoxyCodeLine{82       : matPar\_\{matPar\} \{\}}
\DoxyCodeLine{83 }
\DoxyCodeLine{87   \mbox{\hyperlink{a01526}{MaterialParameters}} \mbox{\hyperlink{a01530_a9bf20249df24ad1909de26378c5d44c8}{materialParametersImpl}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} matPar\_; \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{97   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{98   ST \mbox{\hyperlink{a01530_abf2eefa6dd97cfc5f97d4e8adad71fb8}{storedEnergyImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01530_a1285d903578f2a42247ece4214977a53}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{99     \textcolor{keyword}{const} \mbox{\hyperlink{a01530_a6f6967cf124d7c86783cc01c8849f304}{Invariants<ST>}}\& invariants = Impl::invariants(lambda);}
\DoxyCodeLine{100     ST energy\{0.0\};}
\DoxyCodeLine{101     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& devInvariants = \mbox{\hyperlink{a01538}{DeviatoricInvariants<PrincipalStretches<ST>}}>(lambda);}
\DoxyCodeLine{102     \textcolor{keyword}{const} \textcolor{keyword}{auto} W1             = devInvariants.\mbox{\hyperlink{a01538_a9c016a61bba2d581b57c0f373a7f822c}{value}}()[0];}
\DoxyCodeLine{103     \textcolor{keyword}{const} \textcolor{keyword}{auto} mu             = matPar\_.\mbox{\hyperlink{a01526_a3efa65d2dfee3e53789fb16d7815372b}{mu}};}
\DoxyCodeLine{104     \textcolor{keyword}{const} \textcolor{keyword}{auto} lambdaM        = matPar\_.\mbox{\hyperlink{a01526_a78ad6bdab1c8f663a64abeec58d02f02}{lambdaM}};}
\DoxyCodeLine{105     \textcolor{keyword}{const} \textcolor{keyword}{auto} beta           = 1 / pow(lambdaM, 2.0);}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} i : parameterRange())}
\DoxyCodeLine{108       energy += alphas\_[i] * pow(beta, i) * (pow(W1, i + 1) -\/ pow(3, i + 1));}
\DoxyCodeLine{109     energy *= mu;}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     \textcolor{keywordflow}{return} energy;}
\DoxyCodeLine{112   \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{121   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{122   \mbox{\hyperlink{a01530_aa8e3988e1c8d0d611fb28354e20e5fc6}{FirstDerivative<ST>}} \mbox{\hyperlink{a01530_ac83bfb985c0823c57d2ba3577fa34a29}{firstDerivativeImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01530_a1285d903578f2a42247ece4214977a53}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{123     \textcolor{keyword}{const} \mbox{\hyperlink{a01530_a6f6967cf124d7c86783cc01c8849f304}{Invariants<ST>}}\& invariants = Impl::invariants(lambda);}
\DoxyCodeLine{124     \textcolor{keyword}{auto} dWdLambda                   = \mbox{\hyperlink{a01530_aa8e3988e1c8d0d611fb28354e20e5fc6}{FirstDerivative<ST>::Zero}}().eval();}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& devInvariants = \mbox{\hyperlink{a01538}{DeviatoricInvariants<PrincipalStretches<ST>}}>(lambda);}
\DoxyCodeLine{127     \textcolor{keyword}{const} \textcolor{keyword}{auto} W1             = devInvariants.\mbox{\hyperlink{a01538_a9c016a61bba2d581b57c0f373a7f822c}{value}}()[0];}
\DoxyCodeLine{128     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dW1dLambda    = devInvariants.firstDerivative().first;}
\DoxyCodeLine{129     \textcolor{keyword}{const} \textcolor{keyword}{auto} mu             = matPar\_.\mbox{\hyperlink{a01526_a3efa65d2dfee3e53789fb16d7815372b}{mu}};}
\DoxyCodeLine{130     \textcolor{keyword}{const} \textcolor{keyword}{auto} lambdaM        = matPar\_.\mbox{\hyperlink{a01526_a78ad6bdab1c8f663a64abeec58d02f02}{lambdaM}};}
\DoxyCodeLine{131     \textcolor{keyword}{const} \textcolor{keyword}{auto} beta           = 1 / pow(lambdaM, 2.0);}
\DoxyCodeLine{132 }
\DoxyCodeLine{133     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} j : parameterRange())}
\DoxyCodeLine{134       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} k : dimensionRange())}
\DoxyCodeLine{135         dWdLambda[k] += mu * alphas\_[j] * pow(beta, j) * pow(W1, j) * dW1dLambda[k] * (j + 1);}
\DoxyCodeLine{136 }
\DoxyCodeLine{137     \textcolor{keywordflow}{return} dWdLambda;}
\DoxyCodeLine{138   \}}
\DoxyCodeLine{139 }
\DoxyCodeLine{147   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{148   \mbox{\hyperlink{a01530_aae064ebc679ff3aae55770774d9f2f20}{SecondDerivative<ST>}} \mbox{\hyperlink{a01530_a10c05d2682acc0b38549705176fe421d}{secondDerivativeImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01530_a1285d903578f2a42247ece4214977a53}{PrincipalStretches<ST>}}\& lambda)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{149     \textcolor{keyword}{const} \mbox{\hyperlink{a01530_a6f6967cf124d7c86783cc01c8849f304}{Invariants<ST>}}\& invariants = Impl::invariants(lambda);}
\DoxyCodeLine{150     \textcolor{keyword}{auto} dS                          = \mbox{\hyperlink{a01530_aae064ebc679ff3aae55770774d9f2f20}{SecondDerivative<ST>::Zero}}().eval();}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& devInvariants = \mbox{\hyperlink{a01538}{DeviatoricInvariants<PrincipalStretches<ST>}}>(lambda);}
\DoxyCodeLine{153     \textcolor{keyword}{const} \textcolor{keyword}{auto} W1             = devInvariants.\mbox{\hyperlink{a01538_a9c016a61bba2d581b57c0f373a7f822c}{value}}()[0];}
\DoxyCodeLine{154     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dW1dLambda    = devInvariants.firstDerivative().first;}
\DoxyCodeLine{155     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddW1dLambda   = devInvariants.secondDerivative().first;}
\DoxyCodeLine{156     \textcolor{keyword}{const} \textcolor{keyword}{auto} mu             = matPar\_.\mbox{\hyperlink{a01526_a3efa65d2dfee3e53789fb16d7815372b}{mu}};}
\DoxyCodeLine{157     \textcolor{keyword}{const} \textcolor{keyword}{auto} lambdaM        = matPar\_.\mbox{\hyperlink{a01526_a78ad6bdab1c8f663a64abeec58d02f02}{lambdaM}};}
\DoxyCodeLine{158     \textcolor{keyword}{const} \textcolor{keyword}{auto} beta           = 1 / pow(lambdaM, 2.0);}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{keyword}{const} \textcolor{keyword}{auto} dW1dLambdaDyad = \mbox{\hyperlink{a00407_gab2cea9ac847cc3635812467c9d96ceb4}{dyadic}}(dW1dLambda, dW1dLambda);}
\DoxyCodeLine{161     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} p : parameterRange()) \{}
\DoxyCodeLine{162       \textcolor{keyword}{const} \textcolor{keyword}{auto} factor1 = mu * alphas\_[p] * pow(beta, p);}
\DoxyCodeLine{163       \textcolor{keyword}{const} \textcolor{keyword}{auto} factor2 = pow(W1, p) * ddW1dLambda * (p + 1);}
\DoxyCodeLine{164       \textcolor{keyword}{const} \textcolor{keyword}{auto} factor3 = pow(W1, p -\/ 1) * dW1dLambdaDyad * p * (p + 1);}
\DoxyCodeLine{165       dS += factor1 * (factor2 + factor3);}
\DoxyCodeLine{166       dS.diagonal() -\/= (dW1dLambda.array() / lambda.array() * factor1 * pow(W1, p) * (p + 1)).matrix();}
\DoxyCodeLine{167     \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169     \textcolor{keywordflow}{return} dS;}
\DoxyCodeLine{170   \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{177   \textcolor{keyword}{template} <\textcolor{keyword}{typename} STO>}
\DoxyCodeLine{178   \textcolor{keyword}{auto} \mbox{\hyperlink{a01530_a9f7d11a71c02c6009e2665d78a90dfba}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{179     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01530}{ArrudaBoyceT<STO>}}(matPar\_);}
\DoxyCodeLine{180   \}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \textcolor{keyword}{private}:}
\DoxyCodeLine{183   \mbox{\hyperlink{a01530_aaed928459506869a17c7ed0abb6a3658}{MaterialParameters}} matPar\_;}
\DoxyCodeLine{184   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} std::array<double, numTerms> alphas\_ = \{0.5, 1.0 / 20.0, 11.0 / 1050.0, 19.0 / 7000.0,}
\DoxyCodeLine{185                                                            519.0 / 673750.0\};}
\DoxyCodeLine{186 }
\DoxyCodeLine{187   \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} parameterRange() \{ \textcolor{keywordflow}{return} Dune::range(\mbox{\hyperlink{a01530_a7054465b5882a8d6e9bfa52f1c3a49f7}{numTerms}}); \}}
\DoxyCodeLine{188   \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} dimensionRange() \{ \textcolor{keywordflow}{return} Dune::range(\mbox{\hyperlink{a01530_a4c7f052604e0466671aa6090e41d06e6}{dim}}); \}}
\DoxyCodeLine{189 \};}
\DoxyCodeLine{190 }
\DoxyCodeLine{194 \textcolor{keyword}{using }\mbox{\hyperlink{a01530}{ArrudaBoyce}} = \mbox{\hyperlink{a01530}{ArrudaBoyceT<double>}};}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \} \textcolor{comment}{// namespace Ikarus::Materials}}

\end{DoxyCode}
